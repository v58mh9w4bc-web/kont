<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–ê–¥–º–∏–Ω-–ø–∞–Ω–µ–ª—å ‚Äî –ö–æ–Ω—Ç–∏–Ω–µ–Ω—Ç</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@300;400;500;600;700&family=Cormorant+Garamond:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <style>
        * { font-family: 'Montserrat', sans-serif; }
        .logo-font { font-family: 'Cormorant Garamond', serif; letter-spacing: 0.15em; font-weight: 300; }
        .accent-color { color: #9b8579; }
        .accent-bg { background-color: #c9b8a8; }
        .hover-accent:hover { background-color: #b8a99a; }
        .pastel-bg { background-color: #f5f1ed; }
        .tab-button.active { border-color: #c9b8a8; color: #9b8579; }
        .tab-content.hidden { display: none; }
        .calendar-day {
            min-height: 60px;
            border: 1px solid #e5e7eb;
            cursor: pointer;
            transition: all 0.2s;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            position: relative;
        }
        .calendar-day:hover {
            background-color: #f3f4f6;
            transform: scale(1.02);
        }
        .calendar-day.working {
            background-color: #dcfce7;
            border-color: #16a34a;
        }
        .calendar-day.off {
            background-color: #fecaca;
            border-color: #dc2626;
        }
        .calendar-day.other-month {
            color: #9ca3af;
            background-color: #f9fafb;
        }
        .calendar-day .day-number {
            font-weight: 600;
            font-size: 14px;
        }
        .calendar-day .day-time {
            font-size: 10px;
            margin-top: 2px;
            text-align: center;
        }
    </style>
</head>
<body class="pastel-bg">
    <!-- Header -->
    <header class="bg-white shadow-sm py-5">
        <div class="container mx-auto px-6 flex justify-between items-center">
            <h1 class="text-3xl logo-font accent-color">–ö–û–ù–¢–ò–ù–ï–ù–¢ ‚Äî –ê–¥–º–∏–Ω-–ø–∞–Ω–µ–ª—å</h1>
            <nav class="flex space-x-6">
                <a href="index.html" class="text-gray-700 hover:text-gray-900 transition">–ì–ª–∞–≤–Ω–∞—è</a>
                <a href="crm.html" class="text-gray-700 hover:text-gray-900 transition">CRM</a>
            </nav>
        </div>
    </header>
    <!-- Main Content -->
    <main class="container mx-auto px-6 py-10">
        <!-- Navigation Tabs -->
        <div class="mb-8">
            <div class="border-b border-gray-200">
                <nav class="-mb-px flex space-x-8">
                    <button onclick="showTab('masters')" id="mastersTab" class="tab-button active py-2 px-1 border-b-2 border-gray-400 font-medium text-sm text-gray-800">
                        –ú–∞—Å—Ç–µ—Ä–∞
                    </button>
                    <button onclick="showTab('services')" id="servicesTab" class="tab-button py-2 px-1 border-b-2 border-transparent font-medium text-sm text-gray-500 hover:text-gray-700 hover:border-gray-300">
                        –£—Å–ª—É–≥–∏
                    </button>
                </nav>
            </div>
        </div>

        <!-- Masters Tab -->
        <div id="mastersContent" class="tab-content">
            <div class="grid lg:grid-cols-2 gap-8">
                <!-- Add Master Section -->
                <div class="bg-white rounded-2xl shadow-lg p-8">
                    <h2 class="text-2xl logo-font mb-6 text-gray-800">–î–æ–±–∞–≤–∏—Ç—å –º–∞—Å—Ç–µ—Ä–∞</h2>
                    
                    <form id="addMasterForm" onsubmit="addMaster(event)">
                        <div class="mb-6">
                            <label class="block text-sm font-medium text-gray-700 mb-2">–§–ò–û –º–∞—Å—Ç–µ—Ä–∞</label>
                            <input type="text" id="masterName" required 
                                class="w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-gray-400 focus:border-transparent"
                                placeholder="–ù–∞–ø—Ä–∏–º–µ—Ä: –ê–Ω–Ω–∞ –ò–≤–∞–Ω–æ–≤–∞">
                        </div>

                        <!-- Work Schedule -->
                        <div class="mb-6">
                            <label class="block text-sm font-medium text-gray-700 mb-3">–ì—Ä–∞—Ñ–∏–∫ —Ä–∞–±–æ—Ç—ã –Ω–∞ –º–µ—Å—è—Ü</label>
                            <div class="border border-gray-300 rounded-lg p-4">
                                <!-- Month/Year selector -->
                                <div class="flex items-center justify-between mb-4">
                                    <div class="flex items-center space-x-4">
                                        <select id="scheduleMonth" class="p-2 border border-gray-300 rounded text-sm">
                                            <option value="0">–Ø–Ω–≤–∞—Ä—å</option>
                                            <option value="1">–§–µ–≤—Ä–∞–ª—å</option>
                                            <option value="2">–ú–∞—Ä—Ç</option>
                                            <option value="3">–ê–ø—Ä–µ–ª—å</option>
                                            <option value="4">–ú–∞–π</option>
                                            <option value="5">–ò—é–Ω—å</option>
                                            <option value="6">–ò—é–ª—å</option>
                                            <option value="7">–ê–≤–≥—É—Å—Ç</option>
                                            <option value="8">–°–µ–Ω—Ç—è–±—Ä—å</option>
                                            <option value="9">–û–∫—Ç—è–±—Ä—å</option>
                                            <option value="10">–ù–æ—è–±—Ä—å</option>
                                            <option value="11">–î–µ–∫–∞–±—Ä—å</option>
                                        </select>
                                        <input type="number" id="scheduleYear" min="2024" max="2030" class="p-2 border border-gray-300 rounded text-sm w-20">
                                        <button type="button" onclick="generateMonthSchedule()" class="bg-blue-600 text-white px-3 py-2 rounded text-sm hover:bg-blue-700">
                                            –°–æ–∑–¥–∞—Ç—å –∫–∞–ª–µ–Ω–¥–∞—Ä—å
                                        </button>
                                    </div>
                                    <div class="flex items-center space-x-2">
                                        <button type="button" onclick="setDefaultSchedule()" class="bg-gray-600 text-white px-3 py-2 rounded text-sm hover:bg-gray-700">
                                            –°—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–π –≥—Ä–∞—Ñ–∏–∫
                                        </button>
                                        <button type="button" onclick="clearSchedule()" class="bg-red-600 text-white px-3 py-2 rounded text-sm hover:bg-red-700">
                                            –û—á–∏—Å—Ç–∏—Ç—å
                                        </button>
                                    </div>
                                </div>
                                
                                <!-- Calendar Grid -->
                                <div id="monthCalendar" class="grid grid-cols-7 gap-1 text-xs">
                                    <div class="text-center font-semibold p-2 bg-gray-100">–ü–Ω</div>
                                    <div class="text-center font-semibold p-2 bg-gray-100">–í—Ç</div>
                                    <div class="text-center font-semibold p-2 bg-gray-100">–°—Ä</div>
                                    <div class="text-center font-semibold p-2 bg-gray-100">–ß—Ç</div>
                                    <div class="text-center font-semibold p-2 bg-gray-100">–ü—Ç</div>
                                    <div class="text-center font-semibold p-2 bg-gray-100">–°–±</div>
                                    <div class="text-center font-semibold p-2 bg-gray-100">–í—Å</div>
                                    <!-- Days will be generated here -->
                                </div>
                                
                                <div class="mt-4 text-xs text-gray-600">
                                    <p><strong>–ò–Ω—Å—Ç—Ä—É–∫—Ü–∏—è:</strong> –ö–ª–∏–∫–Ω–∏—Ç–µ –Ω–∞ –¥–∞—Ç—É –¥–ª—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –≤—Ä–µ–º–µ–Ω–∏ —Ä–∞–±–æ—Ç—ã. –ö—Ä–∞—Å–Ω—ã–µ –¥–Ω–∏ - –≤—ã—Ö–æ–¥–Ω—ã–µ, –∑–µ–ª–µ–Ω—ã–µ - —Ä–∞–±–æ—á–∏–µ.</p>
                                </div>
                            </div>
                        </div>

                        <div class="mb-6">
                            <label class="block text-sm font-medium text-gray-700 mb-3">–£—Å–ª—É–≥–∏ –º–∞—Å—Ç–µ—Ä–∞</label>
                            <div class="space-y-4" id="servicesCheckboxes"></div>
                        </div>

                        <button type="submit" class="w-full accent-bg hover-accent text-white py-3 rounded-lg font-semibold transition">
                            –î–æ–±–∞–≤–∏—Ç—å –º–∞—Å—Ç–µ—Ä–∞
                        </button>
                    </form>
                </div>

                <!-- Masters List Section -->
                <div class="bg-white rounded-2xl shadow-lg p-8">
                    <h2 class="text-2xl logo-font mb-6 text-gray-800">–°–ø–∏—Å–æ–∫ –º–∞—Å—Ç–µ—Ä–æ–≤</h2>
                    <div id="mastersList" class="space-y-4"></div>
                </div>
            </div>
        </div>

        <!-- Services Tab -->
        <div id="servicesContent" class="tab-content hidden">
            <div class="grid lg:grid-cols-2 gap-8">
                <!-- Add Service Section -->
                <div class="bg-white rounded-2xl shadow-lg p-8">
                    <h2 class="text-2xl logo-font mb-6 text-gray-800">–î–æ–±–∞–≤–∏—Ç—å —É—Å–ª—É–≥—É</h2>
                    
                    <form id="addServiceForm" onsubmit="addService(event)">
                        <div class="mb-4">
                            <label class="block text-sm font-medium text-gray-700 mb-2">–ù–∞–∑–≤–∞–Ω–∏–µ —É—Å–ª—É–≥–∏</label>
                            <input type="text" id="serviceName" required 
                                class="w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-gray-400 focus:border-transparent"
                                placeholder="–ù–∞–ø—Ä–∏–º–µ—Ä: –ñ–µ–Ω—Å–∫–∞—è —Å—Ç—Ä–∏–∂–∫–∞">
                        </div>

                        <div class="mb-4">
                            <label class="block text-sm font-medium text-gray-700 mb-2">–ö–∞—Ç–µ–≥–æ—Ä–∏—è</label>
                            <select id="serviceCategory" required class="w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-gray-400 focus:border-transparent">
                                <option value="">–í—ã–±–µ—Ä–∏—Ç–µ –∫–∞—Ç–µ–≥–æ—Ä–∏—é</option>
                                <option value="–ú—É–∂—Å–∫–æ–π –∑–∞–ª">–ú—É–∂—Å–∫–æ–π –∑–∞–ª</option>
                                <option value="–ñ–µ–Ω—Å–∫–∏–π –∑–∞–ª">–ñ–µ–Ω—Å–∫–∏–π –∑–∞–ª</option>
                                <option value="–ù–æ–≥—Ç–µ–≤–æ–π —Å–µ—Ä–≤–∏—Å">–ù–æ–≥—Ç–µ–≤–æ–π —Å–µ—Ä–≤–∏—Å</option>
                                <option value="–ö–æ—Å–º–µ—Ç–æ–ª–æ–≥–∏—è">–ö–æ—Å–º–µ—Ç–æ–ª–æ–≥–∏—è</option>
                                <option value="–ë—Ä–æ–≤–∏ –∏ —Ä–µ—Å–Ω–∏—Ü—ã">–ë—Ä–æ–≤–∏ –∏ —Ä–µ—Å–Ω–∏—Ü—ã</option>
                                <option value="–î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ">–î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ</option>
                            </select>
                        </div>

                        <div class="mb-4">
                            <label class="block text-sm font-medium text-gray-700 mb-2">–î–ª–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å (–º–∏–Ω—É—Ç—ã)</label>
                            <input type="number" id="serviceDuration" required min="15" max="300" step="15"
                                class="w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-gray-400 focus:border-transparent"
                                placeholder="60">
                        </div>

                        <div class="mb-6">
                            <label class="block text-sm font-medium text-gray-700 mb-2">–¶–µ–Ω–∞ (—Ä—É–±–ª–µ–π)</label>
                            <input type="number" id="servicePrice" required min="0" step="100"
                                class="w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-gray-400 focus:border-transparent"
                                placeholder="2500">
                        </div>

                        <button type="submit" class="w-full accent-bg hover-accent text-white py-3 rounded-lg font-semibold transition">
                            –î–æ–±–∞–≤–∏—Ç—å —É—Å–ª—É–≥—É
                        </button>
                    </form>
                </div>

                <!-- Services List Section -->
                <div class="bg-white rounded-2xl shadow-lg p-8">
                    <h2 class="text-2xl logo-font mb-6 text-gray-800">–°–ø–∏—Å–æ–∫ —É—Å–ª—É–≥</h2>
                    <div id="servicesList" class="space-y-4"></div>
                </div>
            </div>
        </div>
    </main>

    <!-- Edit Master Modal -->
    <div id="editModal" class="fixed inset-0 bg-black bg-opacity-30 hidden items-center justify-center z-50" style="backdrop-filter: blur(4px);">
        <div class="bg-white rounded-2xl p-8 max-w-4xl w-full mx-4 max-h-[90vh] overflow-y-auto shadow-2xl">
            <h3 class="text-2xl logo-font mb-6 text-gray-800">–†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å –º–∞—Å—Ç–µ—Ä–∞</h3>
            
            <form id="editMasterForm" onsubmit="saveMaster(event)">
                <div class="mb-6">
                    <label class="block text-sm font-medium text-gray-700 mb-2">–§–ò–û –º–∞—Å—Ç–µ—Ä–∞</label>
                    <input type="text" id="editMasterName" required 
                        class="w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-gray-400 focus:border-transparent">
                </div>

                <!-- Edit Work Schedule -->
                <div class="mb-6">
                    <label class="block text-sm font-medium text-gray-700 mb-3">–ì—Ä–∞—Ñ–∏–∫ —Ä–∞–±–æ—Ç—ã –Ω–∞ –º–µ—Å—è—Ü</label>
                    <div class="border border-gray-300 rounded-lg p-4">
                        <!-- Month/Year selector -->
                        <div class="flex items-center justify-between mb-4">
                            <div class="flex items-center space-x-4">
                                <select id="editScheduleMonth" class="p-2 border border-gray-300 rounded text-sm">
                                    <option value="0">–Ø–Ω–≤–∞—Ä—å</option>
                                    <option value="1">–§–µ–≤—Ä–∞–ª—å</option>
                                    <option value="2">–ú–∞—Ä—Ç</option>
                                    <option value="3">–ê–ø—Ä–µ–ª—å</option>
                                    <option value="4">–ú–∞–π</option>
                                    <option value="5">–ò—é–Ω—å</option>
                                    <option value="6">–ò—é–ª—å</option>
                                    <option value="7">–ê–≤–≥—É—Å—Ç</option>
                                    <option value="8">–°–µ–Ω—Ç—è–±—Ä—å</option>
                                    <option value="9">–û–∫—Ç—è–±—Ä—å</option>
                                    <option value="10">–ù–æ—è–±—Ä—å</option>
                                    <option value="11">–î–µ–∫–∞–±—Ä—å</option>
                                </select>
                                <input type="number" id="editScheduleYear" min="2024" max="2030" class="p-2 border border-gray-300 rounded text-sm w-20">
                                <button type="button" onclick="generateEditMonthSchedule()" class="bg-blue-600 text-white px-3 py-2 rounded text-sm hover:bg-blue-700">
                                    –°–æ–∑–¥–∞—Ç—å –∫–∞–ª–µ–Ω–¥–∞—Ä—å
                                </button>
                            </div>
                            <div class="flex items-center space-x-2">
                                <button type="button" onclick="setEditDefaultSchedule()" class="bg-gray-600 text-white px-3 py-2 rounded text-sm hover:bg-gray-700">
                                    –°—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–π –≥—Ä–∞—Ñ–∏–∫
                                </button>
                                <button type="button" onclick="clearEditSchedule()" class="bg-red-600 text-white px-3 py-2 rounded text-sm hover:bg-red-700">
                                    –û—á–∏—Å—Ç–∏—Ç—å
                                </button>
                            </div>
                        </div>
                        
                        <!-- Calendar Grid -->
                        <div id="editMonthCalendar" class="grid grid-cols-7 gap-1 text-xs">
                            <div class="text-center font-semibold p-2 bg-gray-100">–ü–Ω</div>
                            <div class="text-center font-semibold p-2 bg-gray-100">–í—Ç</div>
                            <div class="text-center font-semibold p-2 bg-gray-100">–°—Ä</div>
                            <div class="text-center font-semibold p-2 bg-gray-100">–ß—Ç</div>
                            <div class="text-center font-semibold p-2 bg-gray-100">–ü—Ç</div>
                            <div class="text-center font-semibold p-2 bg-gray-100">–°–±</div>
                            <div class="text-center font-semibold p-2 bg-gray-100">–í—Å</div>
                            <!-- Days will be generated here -->
                        </div>
                        
                        <div class="mt-4 text-xs text-gray-600">
                            <p><strong>–ò–Ω—Å—Ç—Ä—É–∫—Ü–∏—è:</strong> –ö–ª–∏–∫–Ω–∏—Ç–µ –Ω–∞ –¥–∞—Ç—É –¥–ª—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –≤—Ä–µ–º–µ–Ω–∏ —Ä–∞–±–æ—Ç—ã. –ö—Ä–∞—Å–Ω—ã–µ –¥–Ω–∏ - –≤—ã—Ö–æ–¥–Ω—ã–µ, –∑–µ–ª–µ–Ω—ã–µ - —Ä–∞–±–æ—á–∏–µ.</p>
                        </div>
                    </div>
                </div>

                <div class="mb-6">
                    <label class="block text-sm font-medium text-gray-700 mb-3">–£—Å–ª—É–≥–∏ –º–∞—Å—Ç–µ—Ä–∞</label>
                    <div class="space-y-4" id="editServicesCheckboxes"></div>
                </div>

                <div class="flex space-x-4">
                    <button type="submit" class="flex-1 accent-bg hover-accent text-white py-3 rounded-lg font-semibold transition">
                        –°–æ—Ö—Ä–∞–Ω–∏—Ç—å
                    </button>
                    <button type="button" onclick="closeEditModal()" class="flex-1 bg-gray-300 hover:bg-gray-400 text-gray-800 py-3 rounded-lg font-semibold transition">
                        –û—Ç–º–µ–Ω–∞
                    </button>
                </div>
            </form>
        </div>
    </div>

    <!-- Day Schedule Modal -->
    <div id="dayScheduleModal" class="fixed inset-0 bg-black bg-opacity-30 hidden items-center justify-center z-50" style="backdrop-filter: blur(4px);">
        <div class="bg-white rounded-2xl p-6 max-w-md w-full mx-4 shadow-2xl">
            <h3 class="text-xl logo-font mb-4 text-gray-800">–ù–∞—Å—Ç—Ä–æ–π–∫–∞ –¥–Ω—è</h3>
            <p class="text-sm text-gray-600 mb-4">–î–∞—Ç–∞: <span id="selectedDate" class="font-semibold"></span></p>
            
            <div class="mb-4">
                <label class="flex items-center space-x-2 cursor-pointer">
                    <input type="checkbox" id="dayOff" class="w-4 h-4" onchange="toggleDayInputs()">
                    <span class="text-sm font-medium text-gray-700">–í—ã—Ö–æ–¥–Ω–æ–π –¥–µ–Ω—å</span>
                </label>
            </div>
            
            <div id="timeInputs" class="space-y-4">
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-2">–í—Ä–µ–º—è –Ω–∞—á–∞–ª–∞ —Ä–∞–±–æ—Ç—ã</label>
                    <input type="time" id="dayStartTime" class="w-full p-2 border border-gray-300 rounded-lg" value="09:00">
                </div>
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-2">–í—Ä–µ–º—è –æ–∫–æ–Ω—á–∞–Ω–∏—è —Ä–∞–±–æ—Ç—ã</label>
                    <input type="time" id="dayEndTime" class="w-full p-2 border border-gray-300 rounded-lg" value="18:00">
                </div>
            </div>
            
            <div class="flex space-x-4 mt-6">
                <button onclick="saveDaySchedule()" class="flex-1 accent-bg hover-accent text-white py-2 rounded-lg font-semibold transition">
                    –°–æ—Ö—Ä–∞–Ω–∏—Ç—å
                </button>
                <button onclick="closeDayScheduleModal()" class="flex-1 bg-gray-300 hover:bg-gray-400 text-gray-800 py-2 rounded-lg font-semibold transition">
                    –û—Ç–º–µ–Ω–∞
                </button>
            </div>
        </div>
    </div>

    <script>
        // –ü–æ–ª–Ω—ã–π —Å–ø–∏—Å–æ–∫ —É—Å–ª—É–≥ (—Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∏—Ä–æ–≤–∞–Ω —Å booking.js)
        let SERVICES = [
            { id: 'mens_haircut', name: '–ú—É–∂—Å–∫–∞—è —Å—Ç—Ä–∏–∂–∫–∞', duration: 30, category: '–ú—É–∂—Å–∫–æ–π –∑–∞–ª', price: 1500 },
            { id: 'beard_trim', name: '–°—Ç—Ä–∏–∂–∫–∞ –±–æ—Ä–æ–¥—ã', duration: 30, category: '–ú—É–∂—Å–∫–æ–π –∑–∞–ª', price: 800 },
            { id: 'beard_modeling', name: '–ú–æ–¥–µ–ª–∏—Ä–æ–≤–∞–Ω–∏–µ –±–æ—Ä–æ–¥—ã', duration: 60, category: '–ú—É–∂—Å–∫–æ–π –∑–∞–ª', price: 1200 },
            { id: 'royal_shave', name: '–ö–æ—Ä–æ–ª–µ–≤—Å–∫–æ–µ –±—Ä–∏—Ç—å–µ', duration: 60, category: '–ú—É–∂—Å–∫–æ–π –∑–∞–ª', price: 2000 },
            { id: 'gray_camouflage', name: '–ö–∞–º—É—Ñ–ª—è–∂ —Å–µ–¥–∏–Ω—ã', duration: 60, category: '–ú—É–∂—Å–∫–æ–π –∑–∞–ª', price: 1500 },
            
            { id: 'womens_haircut', name: '–ñ–µ–Ω—Å–∫–∞—è —Å—Ç—Ä–∏–∂–∫–∞', duration: 60, category: '–ñ–µ–Ω—Å–∫–∏–π –∑–∞–ª', price: 2500 },
            { id: 'complex_coloring', name: '–°–ª–æ–∂–Ω–æ–µ –æ–∫—Ä–∞—à–∏–≤–∞–Ω–∏–µ', duration: 180, category: '–ñ–µ–Ω—Å–∫–∏–π –∑–∞–ª', price: 8000 },
            { id: 'balayage', name: '–ë–∞–ª–∞—è–∂ / –®–∞—Ç—É—à', duration: 180, category: '–ñ–µ–Ω—Å–∫–∏–π –∑–∞–ª', price: 9000 },
            { id: 'styling', name: '–£–∫–ª–∞–¥–∫–∞', duration: 60, category: '–ñ–µ–Ω—Å–∫–∏–π –∑–∞–ª', price: 1800 },
            { id: 'hair_lamination', name: '–õ–∞–º–∏–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ –≤–æ–ª–æ—Å', duration: 120, category: '–ñ–µ–Ω—Å–∫–∏–π –∑–∞–ª', price: 3500 },
            
            { id: 'manicure', name: '–ú–∞–Ω–∏–∫—é—Ä', duration: 90, category: '–ù–æ–≥—Ç–µ–≤–æ–π —Å–µ—Ä–≤–∏—Å', price: 1500 },
            { id: 'pedicure', name: '–ü–µ–¥–∏–∫—é—Ä', duration: 90, category: '–ù–æ–≥—Ç–µ–≤–æ–π —Å–µ—Ä–≤–∏—Å', price: 2000 },
            { id: 'nail_extension', name: '–ù–∞—Ä–∞—â–∏–≤–∞–Ω–∏–µ –Ω–æ–≥—Ç–µ–π', duration: 120, category: '–ù–æ–≥—Ç–µ–≤–æ–π —Å–µ—Ä–≤–∏—Å', price: 3000 },
            { id: 'nail_design', name: '–î–∏–∑–∞–π–Ω –Ω–æ–≥—Ç–µ–π', duration: 60, category: '–ù–æ–≥—Ç–µ–≤–æ–π —Å–µ—Ä–≤–∏—Å', price: 500 },
            { id: 'nail_strengthening', name: '–£–∫—Ä–µ–ø–ª–µ–Ω–∏–µ –Ω–æ–≥—Ç–µ–π', duration: 60, category: '–ù–æ–≥—Ç–µ–≤–æ–π —Å–µ—Ä–≤–∏—Å', price: 800 },
            
            { id: 'facial_cleaning', name: '–ß–∏—Å—Ç–∫–∞ –ª–∏—Ü–∞', duration: 90, category: '–ö–æ—Å–º–µ—Ç–æ–ª–æ–≥–∏—è', price: 3500 },
            { id: 'peeling', name: '–ü–∏–ª–∏–Ω–≥–∏', duration: 60, category: '–ö–æ—Å–º–µ—Ç–æ–ª–æ–≥–∏—è', price: 2500 },
            { id: 'face_massage', name: '–ú–∞—Å—Å–∞–∂ –ª–∏—Ü–∞', duration: 60, category: '–ö–æ—Å–º–µ—Ç–æ–ª–æ–≥–∏—è', price: 2000 },
            { id: 'facial_treatment', name: '–£—Ö–æ–¥–æ–≤—ã–µ –ø—Ä–æ—Ü–µ–¥—É—Ä—ã', duration: 90, category: '–ö–æ—Å–º–µ—Ç–æ–ª–æ–≥–∏—è', price: 4000 },
            { id: 'mesotherapy', name: '–ú–µ–∑–æ—Ç–µ—Ä–∞–ø–∏—è', duration: 60, category: '–ö–æ—Å–º–µ—Ç–æ–ª–æ–≥–∏—è', price: 5000 },
            
            { id: 'brow_shaping', name: '–û—Ñ–æ—Ä–º–ª–µ–Ω–∏–µ –±—Ä–æ–≤–µ–π', duration: 60, category: '–ë—Ä–æ–≤–∏ –∏ —Ä–µ—Å–Ω–∏—Ü—ã', price: 800 },
            { id: 'brow_coloring', name: '–û–∫—Ä–∞—à–∏–≤–∞–Ω–∏–µ –±—Ä–æ–≤–µ–π', duration: 60, category: '–ë—Ä–æ–≤–∏ –∏ —Ä–µ—Å–Ω–∏—Ü—ã', price: 600 },
            { id: 'brow_lamination', name: '–õ–∞–º–∏–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ –±—Ä–æ–≤–µ–π', duration: 90, category: '–ë—Ä–æ–≤–∏ –∏ —Ä–µ—Å–Ω–∏—Ü—ã', price: 2000 },
            { id: 'lash_extension', name: '–ù–∞—Ä–∞—â–∏–≤–∞–Ω–∏–µ —Ä–µ—Å–Ω–∏—Ü', duration: 120, category: '–ë—Ä–æ–≤–∏ –∏ —Ä–µ—Å–Ω–∏—Ü—ã', price: 2500 },
            { id: 'lash_lamination', name: '–õ–∞–º–∏–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ —Ä–µ—Å–Ω–∏—Ü', duration: 90, category: '–ë—Ä–æ–≤–∏ –∏ —Ä–µ—Å–Ω–∏—Ü—ã', price: 1800 },
            
            { id: 'makeup', name: '–í–∏–∑–∞–∂', duration: 60, category: '–î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ', price: 2500 },
            { id: 'wedding_look', name: '–°–≤–∞–¥–µ–±–Ω—ã–π –æ–±—Ä–∞–∑', duration: 180, category: '–î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ', price: 8000 },
            { id: 'evening_makeup', name: '–í–µ—á–µ—Ä–Ω–∏–π –º–∞–∫–∏—è–∂', duration: 90, category: '–î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ', price: 3500 },
            { id: 'stylist_consultation', name: '–ö–æ–Ω—Å—É–ª—å—Ç–∞—Ü–∏—è —Å—Ç–∏–ª–∏—Å—Ç–∞', duration: 60, category: '–î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ', price: 2000 },
        ];

        let currentEditMasterId = null;
        let currentScheduleData = {};
        let currentEditScheduleData = {};
        let selectedDateForEdit = null;
        let isEditMode = false;

        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ
        document.addEventListener('DOMContentLoaded', () => {
            loadServicesFromStorage();
            renderServicesCheckboxes('servicesCheckboxes');
            loadMasters();
            loadServicesList();
            
            // –£—Å—Ç–∞–Ω–æ–≤–∫–∞ —Ç–µ–∫—É—â–µ–≥–æ –º–µ—Å—è—Ü–∞ –∏ –≥–æ–¥–∞
            const now = new Date();
            document.getElementById('scheduleMonth').value = now.getMonth();
            document.getElementById('scheduleYear').value = now.getFullYear();
            document.getElementById('editScheduleMonth').value = now.getMonth();
            document.getElementById('editScheduleYear').value = now.getFullYear();
        });

        // –ó–∞–≥—Ä—É–∑–∫–∞ —É—Å–ª—É–≥ –∏–∑ localStorage
        function loadServicesFromStorage() {
            const savedServices = localStorage.getItem('services');
            if (savedServices) {
                SERVICES = JSON.parse(savedServices);
            } else {
                // –°–æ—Ö—Ä–∞–Ω—è–µ–º –¥–µ—Ñ–æ–ª—Ç–Ω—ã–µ —É—Å–ª—É–≥–∏ –ø—Ä–∏ –ø–µ—Ä–≤–æ–º –∑–∞–ø—É—Å–∫–µ
                localStorage.setItem('services', JSON.stringify(SERVICES));
            }
        }

        // –ü–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–µ —Ç–∞–±–æ–≤
        function showTab(tabName) {
            // –°–∫—Ä—ã—Ç—å –≤—Å–µ —Ç–∞–±—ã
            document.querySelectorAll('.tab-content').forEach(tab => tab.classList.add('hidden'));
            document.querySelectorAll('.tab-button').forEach(btn => btn.classList.remove('active'));
            
            // –ü–æ–∫–∞–∑–∞—Ç—å –≤—ã–±—Ä–∞–Ω–Ω—ã–π —Ç–∞–±
            document.getElementById(tabName + 'Content').classList.remove('hidden');
            document.getElementById(tabName + 'Tab').classList.add('active');
            
            if (tabName === 'services') {
                loadServicesList();
            }
        }

        // –§—É–Ω–∫—Ü–∏–∏ –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å –º–µ—Å—è—á–Ω—ã–º –∫–∞–ª–µ–Ω–¥–∞—Ä–µ–º
        function generateMonthSchedule() {
            isEditMode = false;
            const month = parseInt(document.getElementById('scheduleMonth').value);
            const year = parseInt(document.getElementById('scheduleYear').value);
            generateCalendar('monthCalendar', month, year, currentScheduleData);
        }

        function generateEditMonthSchedule() {
            isEditMode = true;
            const month = parseInt(document.getElementById('editScheduleMonth').value);
            const year = parseInt(document.getElementById('editScheduleYear').value);
            generateCalendar('editMonthCalendar', month, year, currentEditScheduleData);
        }

        function generateCalendar(containerId, month, year, scheduleData) {
            const container = document.getElementById(containerId);
            const firstDay = new Date(year, month, 1);
            const lastDay = new Date(year, month + 1, 0);
            const daysInMonth = lastDay.getDate();
            const startingDayOfWeek = (firstDay.getDay() + 6) % 7; // –ü–æ–Ω–µ–¥–µ–ª—å–Ω–∏–∫ = 0
            
            // –û—á–∏—â–∞–µ–º –∫–∞–ª–µ–Ω–¥–∞—Ä—å, –æ—Å—Ç–∞–≤–ª—è—è –∑–∞–≥–æ–ª–æ–≤–∫–∏
            const headers = container.querySelectorAll('.font-semibold');
            container.innerHTML = '';
            headers.forEach(header => container.appendChild(header));
            
            // –î–æ–±–∞–≤–ª—è–µ–º –ø—É—Å—Ç—ã–µ —è—á–µ–π–∫–∏ –¥–ª—è –¥–Ω–µ–π –ø—Ä–µ–¥—ã–¥—É—â–µ–≥–æ –º–µ—Å—è—Ü–∞
            for (let i = 0; i < startingDayOfWeek; i++) {
                const emptyDay = document.createElement('div');
                emptyDay.className = 'calendar-day other-month';
                container.appendChild(emptyDay);
            }
            
            // –î–æ–±–∞–≤–ª—è–µ–º –¥–Ω–∏ —Ç–µ–∫—É—â–µ–≥–æ –º–µ—Å—è—Ü–∞
            for (let day = 1; day <= daysInMonth; day++) {
                const dayElement = document.createElement('div');
                const dateKey = `${year}-${String(month + 1).padStart(2, '0')}-${String(day).padStart(2, '0')}`;
                
                dayElement.className = 'calendar-day';
                dayElement.onclick = () => openDayScheduleModal(dateKey);
                
                const dayNumber = document.createElement('div');
                dayNumber.className = 'day-number';
                dayNumber.textContent = day;
                dayElement.appendChild(dayNumber);
                
                // –ü—Ä–æ–≤–µ—Ä—è–µ–º, –µ—Å—Ç—å –ª–∏ –¥–∞–Ω–Ω—ã–µ –¥–ª—è —ç—Ç–æ–≥–æ –¥–Ω—è
                if (scheduleData[dateKey]) {
                    const dayTime = document.createElement('div');
                    dayTime.className = 'day-time';
                    
                    if (scheduleData[dateKey].isOff) {
                        dayElement.classList.add('off');
                        dayTime.textContent = '–í—ã—Ö–æ–¥–Ω–æ–π';
                    } else {
                        dayElement.classList.add('working');
                        dayTime.textContent = `${scheduleData[dateKey].start}-${scheduleData[dateKey].end}`;
                    }
                    
                    dayElement.appendChild(dayTime);
                }
                
                container.appendChild(dayElement);
            }
        }

        function openDayScheduleModal(dateKey) {
            selectedDateForEdit = dateKey;
            const scheduleData = isEditMode ? currentEditScheduleData : currentScheduleData;
            
            document.getElementById('selectedDate').textContent = formatDateForDisplay(dateKey);
            
            if (scheduleData[dateKey]) {
                document.getElementById('dayOff').checked = scheduleData[dateKey].isOff || false;
                document.getElementById('dayStartTime').value = scheduleData[dateKey].start || '09:00';
                document.getElementById('dayEndTime').value = scheduleData[dateKey].end || '18:00';
            } else {
                // –î–µ—Ñ–æ–ª—Ç–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è
                const date = new Date(dateKey);
                const dayOfWeek = date.getDay();
                document.getElementById('dayOff').checked = dayOfWeek === 0; // –í–æ—Å–∫—Ä–µ—Å–µ–Ω—å–µ
                document.getElementById('dayStartTime').value = (dayOfWeek === 6 || dayOfWeek === 0) ? '10:00' : '09:00';
                document.getElementById('dayEndTime').value = dayOfWeek === 6 ? '17:00' : dayOfWeek === 0 ? '16:00' : '18:00';
            }
            
            toggleDayInputs();
            document.getElementById('dayScheduleModal').classList.remove('hidden');
            document.getElementById('dayScheduleModal').classList.add('flex');
        }

        function toggleDayInputs() {
            const isOff = document.getElementById('dayOff').checked;
            const timeInputs = document.getElementById('timeInputs');
            timeInputs.style.opacity = isOff ? '0.5' : '1';
            timeInputs.style.pointerEvents = isOff ? 'none' : 'auto';
        }

        function saveDaySchedule() {
            const scheduleData = isEditMode ? currentEditScheduleData : currentScheduleData;
            
            scheduleData[selectedDateForEdit] = {
                start: document.getElementById('dayStartTime').value,
                end: document.getElementById('dayEndTime').value,
                isOff: document.getElementById('dayOff').checked
            };
            
            closeDayScheduleModal();
            
            // –û–±–Ω–æ–≤–ª—è–µ–º –∫–∞–ª–µ–Ω–¥–∞—Ä—å
            if (isEditMode) {
                generateEditMonthSchedule();
            } else {
                generateMonthSchedule();
            }
        }

        function closeDayScheduleModal() {
            document.getElementById('dayScheduleModal').classList.add('hidden');
            document.getElementById('dayScheduleModal').classList.remove('flex');
            selectedDateForEdit = null;
        }

        function setDefaultSchedule() {
            const month = parseInt(document.getElementById('scheduleMonth').value);
            const year = parseInt(document.getElementById('scheduleYear').value);
            setDefaultScheduleForMonth(currentScheduleData, month, year);
            generateMonthSchedule();
        }

        function setEditDefaultSchedule() {
            const month = parseInt(document.getElementById('editScheduleMonth').value);
            const year = parseInt(document.getElementById('editScheduleYear').value);
            setDefaultScheduleForMonth(currentEditScheduleData, month, year);
            generateEditMonthSchedule();
        }

        function setDefaultScheduleForMonth(scheduleData, month, year) {
            const daysInMonth = new Date(year, month + 1, 0).getDate();
            
            for (let day = 1; day <= daysInMonth; day++) {
                const date = new Date(year, month, day);
                const dayOfWeek = date.getDay();
                const dateKey = `${year}-${String(month + 1).padStart(2, '0')}-${String(day).padStart(2, '0')}`;
                
                scheduleData[dateKey] = {
                    start: (dayOfWeek === 6 || dayOfWeek === 0) ? '10:00' : '09:00',
                    end: dayOfWeek === 6 ? '17:00' : dayOfWeek === 0 ? '16:00' : '18:00',
                    isOff: dayOfWeek === 0 // –í–æ—Å–∫—Ä–µ—Å–µ–Ω—å–µ - –≤—ã—Ö–æ–¥–Ω–æ–π
                };
            }
        }

        function clearSchedule() {
            currentScheduleData = {};
            generateMonthSchedule();
        }

        function clearEditSchedule() {
            currentEditScheduleData = {};
            generateEditMonthSchedule();
        }

        function formatDateForDisplay(dateKey) {
            const date = new Date(dateKey);
            const options = { 
                weekday: 'long', 
                year: 'numeric', 
                month: 'long', 
                day: 'numeric' 
            };
            return date.toLocaleDateString('ru-RU', options);
        }

        // –†–µ–Ω–¥–µ—Ä —á–µ–∫–±–æ–∫—Å–æ–≤ —É—Å–ª—É–≥
        function renderServicesCheckboxes(containerId, selectedServices = []) {
            const container = document.getElementById(containerId);
            const groupedServices = {};
            
            SERVICES.forEach(service => {
                if (!groupedServices[service.category]) {
                    groupedServices[service.category] = [];
                }
                groupedServices[service.category].push(service);
            });
            
            let html = '';
            Object.keys(groupedServices).forEach(category => {
                html += `<div class="border-l-4 border-gray-400 pl-4 bg-gray-50 p-3 rounded">
                    <h4 class="font-semibold text-gray-800 mb-2">${category}</h4>
                    <div class="space-y-2">`;
                
                groupedServices[category].forEach(service => {
                    const checked = selectedServices.includes(service.id) ? 'checked' : '';
                    html += `<label class="flex items-center space-x-2 cursor-pointer">
                        <input type="checkbox" name="services" value="${service.id}" ${checked}
                            class="w-4 h-4 text-gray-600 border-gray-300 rounded focus:ring-gray-400">
                        <span class="text-gray-700">${service.name}</span>
                    </label>`;
                });
                
                html += `</div></div>`;
            });
            
            container.innerHTML = html;
        }

        // –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –º–∞—Å—Ç–µ—Ä–∞
        function addMaster(event) {
            event.preventDefault();
            
            const name = document.getElementById('masterName').value.trim();
            const checkboxes = document.querySelectorAll('#servicesCheckboxes input[name="services"]:checked');
            const services = Array.from(checkboxes).map(cb => cb.value);
            
            if (!name) {
                alert('–í–≤–µ–¥–∏—Ç–µ –§–ò–û –º–∞—Å—Ç–µ—Ä–∞');
                return;
            }
            
            if (services.length === 0) {
                alert('–í—ã–±–µ—Ä–∏—Ç–µ —Ö–æ—Ç—è –±—ã –æ–¥–Ω—É —É—Å–ª—É–≥—É');
                return;
            }
            
            const masters = JSON.parse(localStorage.getItem('masters') || '[]');
            const newMaster = {
                id: Date.now(),
                name: name,
                services: services,
                schedule: { ...currentScheduleData } // –ö–æ–ø–∏—Ä—É–µ–º –≥—Ä–∞—Ñ–∏–∫
            };
            
            masters.push(newMaster);
            localStorage.setItem('masters', JSON.stringify(masters));
            
            document.getElementById('addMasterForm').reset();
            currentScheduleData = {}; // –û—á–∏—â–∞–µ–º –≥—Ä–∞—Ñ–∏–∫
            document.getElementById('monthCalendar').innerHTML = `
                <div class="text-center font-semibold p-2 bg-gray-100">–ü–Ω</div>
                <div class="text-center font-semibold p-2 bg-gray-100">–í—Ç</div>
                <div class="text-center font-semibold p-2 bg-gray-100">–°—Ä</div>
                <div class="text-center font-semibold p-2 bg-gray-100">–ß—Ç</div>
                <div class="text-center font-semibold p-2 bg-gray-100">–ü—Ç</div>
                <div class="text-center font-semibold p-2 bg-gray-100">–°–±</div>
                <div class="text-center font-semibold p-2 bg-gray-100">–í—Å</div>
            `;
            loadMasters();
            alert('–ú–∞—Å—Ç–µ—Ä —É—Å–ø–µ—à–Ω–æ –¥–æ–±–∞–≤–ª–µ–Ω!');
        }

        // –ó–∞–≥—Ä—É–∑–∫–∞ —Å–ø–∏—Å–∫–∞ –º–∞—Å—Ç–µ—Ä–æ–≤
        function loadMasters() {
            const masters = JSON.parse(localStorage.getItem('masters') || '[]');
            const container = document.getElementById('mastersList');
            
            if (masters.length === 0) {
                container.innerHTML = '<p class="text-gray-500 text-center py-8">–ù–µ—Ç –¥–æ–±–∞–≤–ª–µ–Ω–Ω—ã—Ö –º–∞—Å—Ç–µ—Ä–æ–≤</p>';
                return;
            }
            
            let html = '';
            masters.forEach(master => {
                const serviceNames = master.services.map(sid => {
                    const service = SERVICES.find(s => s.id === sid);
                    return service ? service.name : sid;
                });
                
                // –§–æ—Ä–º–∏—Ä–æ–≤–∞–Ω–∏–µ —Å—Ç—Ä–æ–∫–∏ –≥—Ä–∞—Ñ–∏–∫–∞ —Ä–∞–±–æ—Ç—ã
                const scheduleText = getScheduleText(master.schedule);
                
                html += `<div class="border border-gray-200 rounded-xl p-6 hover:shadow-lg transition">
                    <div class="flex justify-between items-start mb-4">
                        <h3 class="text-xl font-bold text-gray-900">${master.name}</h3>
                        <div class="flex space-x-2">
                            <button onclick="editMaster(${master.id})" 
                                class="text-blue-600 hover:text-blue-800 font-medium text-sm">
                                –†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å
                            </button>
                            <button onclick="deleteMaster(${master.id})" 
                                class="text-red-600 hover:text-red-800 font-medium text-sm">
                                –£–¥–∞–ª–∏—Ç—å
                            </button>
                        </div>
                    </div>
                    <div class="text-sm text-gray-600 mb-3">
                        <strong>–ì—Ä–∞—Ñ–∏–∫ —Ä–∞–±–æ—Ç—ã:</strong><br>
                        <span class="text-xs">${scheduleText}</span>
                    </div>
                    <div class="text-sm text-gray-600">
                        <strong>–£—Å–ª—É–≥–∏ (${master.services.length}):</strong>
                        <div class="mt-2 flex flex-wrap gap-2">
                            ${serviceNames.map(name => 
                                `<span class="bg-gray-100 px-3 py-1 rounded-full text-xs">${name}</span>`
                            ).join('')}
                        </div>
                    </div>
                </div>`;
            });
            
            container.innerHTML = html;
        }

        // –ü–æ–ª—É—á–µ–Ω–∏–µ —Ç–µ–∫—Å—Ç–æ–≤–æ–≥–æ –æ–ø–∏—Å–∞–Ω–∏—è –≥—Ä–∞—Ñ–∏–∫–∞ —Ä–∞–±–æ—Ç—ã
        function getScheduleText(schedule) {
            if (!schedule || Object.keys(schedule).length === 0) return '–ù–µ –Ω–∞—Å—Ç—Ä–æ–µ–Ω';
            
            const dates = Object.keys(schedule).sort();
            if (dates.length === 0) return '–ù–µ –Ω–∞—Å—Ç—Ä–æ–µ–Ω';
            
            const workingDays = dates.filter(date => !schedule[date].isOff).length;
            const offDays = dates.filter(date => schedule[date].isOff).length;
            
            let result = `–ù–∞—Å—Ç—Ä–æ–µ–Ω –Ω–∞ ${dates.length} –¥–Ω–µ–π`;
            if (workingDays > 0) result += `, —Ä–∞–±–æ—á–∏—Ö: ${workingDays}`;
            if (offDays > 0) result += `, –≤—ã—Ö–æ–¥–Ω—ã—Ö: ${offDays}`;
            
            return result;
        }

        // –†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –º–∞—Å—Ç–µ—Ä–∞
        function editMaster(masterId) {
            const masters = JSON.parse(localStorage.getItem('masters') || '[]');
            const master = masters.find(m => m.id === masterId);
            
            if (!master) return;
            
            currentEditMasterId = masterId;
            document.getElementById('editMasterName').value = master.name;
            renderServicesCheckboxes('editServicesCheckboxes', master.services);
            
            // –ó–∞–≥—Ä—É–∂–∞–µ–º –≥—Ä–∞—Ñ–∏–∫ –º–∞—Å—Ç–µ—Ä–∞
            currentEditScheduleData = master.schedule ? { ...master.schedule } : {};
            
            document.getElementById('editModal').classList.remove('hidden');
            document.getElementById('editModal').classList.add('flex');
        }

        // –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –∏–∑–º–µ–Ω–µ–Ω–∏–π –º–∞—Å—Ç–µ—Ä–∞
        function saveMaster(event) {
            event.preventDefault();
            
            const name = document.getElementById('editMasterName').value.trim();
            const checkboxes = document.querySelectorAll('#editServicesCheckboxes input[name="services"]:checked');
            const services = Array.from(checkboxes).map(cb => cb.value);
            
            if (!name) {
                alert('–í–≤–µ–¥–∏—Ç–µ –§–ò–û –º–∞—Å—Ç–µ—Ä–∞');
                return;
            }
            
            if (services.length === 0) {
                alert('–í—ã–±–µ—Ä–∏—Ç–µ —Ö–æ—Ç—è –±—ã –æ–¥–Ω—É —É—Å–ª—É–≥—É');
                return;
            }
            
            const masters = JSON.parse(localStorage.getItem('masters') || '[]');
            const index = masters.findIndex(m => m.id === currentEditMasterId);
            
            if (index !== -1) {
                masters[index].name = name;
                masters[index].services = services;
                masters[index].schedule = { ...currentEditScheduleData }; // –°–æ—Ö—Ä–∞–Ω—è–µ–º –≥—Ä–∞—Ñ–∏–∫
                localStorage.setItem('masters', JSON.stringify(masters));
                loadMasters();
                closeEditModal();
                alert('–ò–∑–º–µ–Ω–µ–Ω–∏—è —Å–æ—Ö—Ä–∞–Ω–µ–Ω—ã!');
            }
        }

        // –ó–∞–∫—Ä—ã—Ç–∏–µ –º–æ–¥–∞–ª—å–Ω–æ–≥–æ –æ–∫–Ω–∞
        function closeEditModal() {
            document.getElementById('editModal').classList.add('hidden');
            document.getElementById('editModal').classList.remove('flex');
            currentEditMasterId = null;
            currentEditScheduleData = {};
        }

        // –£–¥–∞–ª–µ–Ω–∏–µ –º–∞—Å—Ç–µ—Ä–∞
        function deleteMaster(masterId) {
            if (!confirm('–í—ã —É–≤–µ—Ä–µ–Ω—ã, —á—Ç–æ —Ö–æ—Ç–∏—Ç–µ —É–¥–∞–ª–∏—Ç—å —ç—Ç–æ–≥–æ –º–∞—Å—Ç–µ—Ä–∞?')) return;
            
            const masters = JSON.parse(localStorage.getItem('masters') || '[]');
            const filtered = masters.filter(m => m.id !== masterId);
            localStorage.setItem('masters', JSON.stringify(filtered));
            loadMasters();
            alert('–ú–∞—Å—Ç–µ—Ä —É–¥–∞–ª–µ–Ω');
        }
        // –§—É–Ω–∫—Ü–∏–∏ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è —É—Å–ª—É–≥–∞–º–∏
        function addService(event) {
            event.preventDefault();
            
            const name = document.getElementById('serviceName').value.trim();
            const category = document.getElementById('serviceCategory').value;
            const duration = parseInt(document.getElementById('serviceDuration').value);
            const price = parseInt(document.getElementById('servicePrice').value);
            
            if (!name || !category || !duration || !price) {
                alert('–ó–∞–ø–æ–ª–Ω–∏—Ç–µ –≤—Å–µ –ø–æ–ª—è');
                return;
            }
            
            // –ì–µ–Ω–µ—Ä–∏—Ä—É–µ–º ID –∏–∑ –Ω–∞–∑–≤–∞–Ω–∏—è
            const id = name.toLowerCase()
                .replace(/[^–∞-—è—ë\s]/gi, '')
                .replace(/\s+/g, '_')
                .replace(/[^a-z0-9_]/gi, '');
            
            // –ü—Ä–æ–≤–µ—Ä—è–µ–º —É–Ω–∏–∫–∞–ª—å–Ω–æ—Å—Ç—å ID
            if (SERVICES.find(s => s.id === id)) {
                alert('–£—Å–ª—É–≥–∞ —Å —Ç–∞–∫–∏–º –Ω–∞–∑–≤–∞–Ω–∏–µ–º —É–∂–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç');
                return;
            }
            
            const newService = {
                id: id,
                name: name,
                category: category,
                duration: duration,
                price: price
            };
            
            SERVICES.push(newService);
            localStorage.setItem('services', JSON.stringify(SERVICES));
            
            document.getElementById('addServiceForm').reset();
            loadServicesList();
            renderServicesCheckboxes('servicesCheckboxes');
            alert('–£—Å–ª—É–≥–∞ —É—Å–ø–µ—à–Ω–æ –¥–æ–±–∞–≤–ª–µ–Ω–∞!');
        }

        function loadServicesList() {
            const container = document.getElementById('servicesList');
            
            if (SERVICES.length === 0) {
                container.innerHTML = '<p class="text-gray-500 text-center py-8">–ù–µ—Ç –¥–æ–±–∞–≤–ª–µ–Ω–Ω—ã—Ö —É—Å–ª—É–≥</p>';
                return;
            }
            
            // –ì—Ä—É–ø–ø–∏—Ä—É–µ–º —É—Å–ª—É–≥–∏ –ø–æ –∫–∞—Ç–µ–≥–æ—Ä–∏—è–º
            const groupedServices = {};
            SERVICES.forEach(service => {
                if (!groupedServices[service.category]) {
                    groupedServices[service.category] = [];
                }
                groupedServices[service.category].push(service);
            });
            
            let html = '';
            Object.keys(groupedServices).forEach(category => {
                html += `<div class="mb-6">
                    <h4 class="font-semibold text-gray-800 mb-3 border-b pb-2">${category}</h4>`;
                
                groupedServices[category].forEach(service => {
                    html += `<div class="border border-gray-200 rounded-lg p-4 mb-2 hover:shadow-md transition">
                        <div class="flex justify-between items-start">
                            <div class="flex-1">
                                <h5 class="font-medium text-gray-900">${service.name}</h5>
                                <div class="text-sm text-gray-600 mt-1">
                                    <span class="mr-4">‚è±Ô∏è ${service.duration} –º–∏–Ω</span>
                                    <span>üí∞ ${service.price}‚ÇΩ</span>
                                </div>
                            </div>
                            <button onclick="deleteService('${service.id}')" 
                                class="text-red-600 hover:text-red-800 font-medium text-sm ml-4">
                                –£–¥–∞–ª–∏—Ç—å
                            </button>
                        </div>
                    </div>`;
                });
                
                html += `</div>`;
            });
            
            container.innerHTML = html;
        }

        function deleteService(serviceId) {
            if (!confirm('–í—ã —É–≤–µ—Ä–µ–Ω—ã, —á—Ç–æ —Ö–æ—Ç–∏—Ç–µ —É–¥–∞–ª–∏—Ç—å —ç—Ç—É —É—Å–ª—É–≥—É?')) return;
            
            // –ü—Ä–æ–≤–µ—Ä—è–µ–º, –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –ª–∏ —É—Å–ª—É–≥–∞ –º–∞—Å—Ç–µ—Ä–∞–º–∏
            const masters = JSON.parse(localStorage.getItem('masters') || '[]');
            const mastersUsingService = masters.filter(master => 
                master.services && master.services.includes(serviceId)
            );
            
            if (mastersUsingService.length > 0) {
                const masterNames = mastersUsingService.map(m => m.name).join(', ');
                if (!confirm(`–≠—Ç–∞ —É—Å–ª—É–≥–∞ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –º–∞—Å—Ç–µ—Ä–∞–º–∏: ${masterNames}. –£–¥–∞–ª–∏—Ç—å –≤—Å–µ —Ä–∞–≤–Ω–æ?`)) {
                    return;
                }
                
                // –£–¥–∞–ª—è–µ–º —É—Å–ª—É–≥—É —É –≤—Å–µ—Ö –º–∞—Å—Ç–µ—Ä–æ–≤
                masters.forEach(master => {
                    if (master.services) {
                        master.services = master.services.filter(sid => sid !== serviceId);
                    }
                });
                localStorage.setItem('masters', JSON.stringify(masters));
            }
            
            // –£–¥–∞–ª—è–µ–º —É—Å–ª—É–≥—É
            const serviceIndex = SERVICES.findIndex(s => s.id === serviceId);
            if (serviceIndex !== -1) {
                SERVICES.splice(serviceIndex, 1);
                localStorage.setItem('services', JSON.stringify(SERVICES));
                loadServicesList();
                renderServicesCheckboxes('servicesCheckboxes');
                loadMasters(); // –û–±–Ω–æ–≤–ª—è–µ–º —Å–ø–∏—Å–æ–∫ –º–∞—Å—Ç–µ—Ä–æ–≤
                alert('–£—Å–ª—É–≥–∞ —É–¥–∞–ª–µ–Ω–∞');
            }
        }
    </script>
</body>
</html>
